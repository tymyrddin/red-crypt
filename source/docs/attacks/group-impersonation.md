# Impersonation attack (Group message)

## Attack tree

```text
1 Retrieve a members public key from the key server (AND)
2 Derive Key and Initialisation Vector from a group-shared key and a randomly-generated salt (AND)
3 Generate a ciphertext C and a tag T (AND)
4 Prepare a packet D: D=version‖content type‖salt‖C‖T‖sender key ID‖recipient key ID, where 
    sender key ID is set to the one being impersonated.
5 Broadcast D to all members via the key server.
```

## Notes

* A malicious group member impersonates a member in a group message encryption, exploiting a vulnerability of the key derivation phase, for example when Key and Initialisation Vector for the symmetric-key encryption are derived from a group-shared key and sender’s public information. In this case, a group member who wants to send a message to a group, first computes a shared secret from a group key and sender’s public key. Since a malicious member also possesses the group key and is able to retrieve sender’s public key from the key server, he/she can compute the Shared Secret and is able to derive Key and Initialisation Vector.
* A malicious member is able to compute any group member’s key and Initialisation Vector for the group message. Because the tag T is generated by a valid key, group members except the impersonated user do not notice the attack. When the impersonated user sees the fake message, there may or may not be a formal way to refute. If not, the group message encryption does not provide for proving authenticity of the message.




